(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3175],{31814:function(e,t,r){Promise.resolve().then(r.bind(r,1130))},1130:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var a=r(57437),n=r(2265),s=r(18079),l=r(99376),i=r(61273),o=r(49677),c=r(56870);function u(){let e=(0,l.useSearchParams)(),t=(0,l.useRouter)(),r=(0,c.Y)(),[u,d]=(0,n.useState)([]),f=async()=>{d((await navigator.mediaDevices.enumerateDevices()).filter(e=>"audioinput"===e.kind));let e=u.find(e=>e.label.includes("AirPods"));e&&p(e.deviceId)};(0,n.useEffect)(()=>{if(void 0===navigator.mediaDevices){console.log("navigator.mediaDevices is undefined");return}f(),navigator.mediaDevices.ondevicechange=f},[]),(0,n.useEffect)(()=>{let e=setInterval(()=>{f()},1e3);return()=>clearInterval(e)},[]);let{selectedMic:m,acquireMic:p,isVoiceDetected:h}=(0,o.Z)({recordingChunkSize:100}),[b,v]=(0,n.useState)(!1),[x,y]=(0,n.useState)("Beginner"),[j,g]=(0,n.useState)(!1),w=(e,a,n)=>{g(!0),(0,s.oY)({path:{service:"ws"},query:{tutoring_id:e,lesson_id:a,mode:n}}).then(e=>{e.data&&(r.resume(),t.replace("/call?session_id=".concat(e.data.session_id)))}).catch(e=>{console.error(e)})};return(0,a.jsxs)("main",{className:"h-screen-safe flex flex-col justify-between bg-[#FAFBFF] pt-5 tracking-[-0.02em]",children:[(0,a.jsx)("div",{className:"flex w-full flex-col items-center px-7 pb-6",children:(0,a.jsxs)("div",{className:"flex w-full items-center justify-between px-1",children:[(0,a.jsx)("button",{className:"flex h-12 items-center justify-center self-start rounded-full text-black",onClick:()=>{t.replace("/")},children:(0,a.jsx)(i._0w,{className:"text-xl"})}),(0,a.jsx)("button",{className:"flex h-12 items-center justify-center self-start rounded-full text-black/30",onClick:()=>{},children:(0,a.jsx)(i.kvo,{className:"text-xl"})})]})}),(0,a.jsx)("div",{className:"overflow-y-auto",children:e.get("tutoring_id")&&e.get("lesson_id")?(0,a.jsxs)("div",{className:"flex flex-col gap-5 px-7",children:[(0,a.jsx)("div",{className:"flex h-full w-full flex-col items-center justify-center gap-4 pb-12",children:[{name:"Beginner",value:"Beginner",description:"We give you all the cheats!",emoji:"\uD83D\uDC66\uD83C\uDFFB",activated:!0},{name:"Intermediate",value:"Intermediate",description:"Can you deal without translations?",emoji:"\uD83C\uDFEB",activated:!0},{name:"Advanced",value:"Advanced",description:"No more training wheels!",emoji:"\uD83D\uDC69\uD83C\uDFFB‍\uD83C\uDF93",activated:!0},{name:"Native (Experimental)",value:"Realtime",description:"Real time conversation like a native!",emoji:"\uD83E\uDDD0",activated:!0}].map(e=>(0,a.jsxs)("button",{className:"flex w-full items-center gap-3 rounded-lg border-[1px] px-7 py-4 text-base ".concat(x===e.value?"border-[#0039FF] bg-[#0039FF]/5 text-[#0039FF]":"border-black/10 bg-white"," ").concat(!e.activated&&"opacity-50"),onClick:()=>{e.activated&&y(e.value)},children:[(0,a.jsx)("p",{className:"mr-3 text-2xl",children:e.emoji}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-medium",children:e.name}),(0,a.jsx)("p",{className:"text-sm font-light text-black/50",children:e.description})]})]},e.value))}),(0,a.jsxs)("button",{className:"text-center font-light text-black/30 underline",onClick:()=>{v(!b)},children:[b?"Hide":"Show"," audio device options"]}),b&&(0,a.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,a.jsx)("div",{className:"flex flex-col gap-2",children:u.map(e=>(0,a.jsx)("button",{className:"flex w-full items-center justify-between rounded-lg border px-3 py-3 font-normal ".concat(m==e.deviceId?"border-[#0039FF] bg-[#0039FF]/5 text-[#0039FF]":"bg-white"),onClick:()=>{p(e.deviceId)},children:(0,a.jsx)("p",{className:"text-sm",children:e.label||"Unknown Microphone"})},e.deviceId))}),(0,a.jsxs)("div",{className:"mb-12 flex items-center gap-2 text-sm text-black/30",children:[(0,a.jsx)("p",{children:"Try speaking to test your microphone:"}),(0,a.jsx)("div",{className:"flex h-1 w-8 items-center justify-center rounded-full ".concat(h?"bg-green-500":"bg-black/10")})]})]})]}):(0,a.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-black",children:"No Lesson Found"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No lesson found to start."})]})}),(0,a.jsx)("div",{className:"pointer-events-none w-full justify-end gap-5 tracking-[-0.02em]",children:(0,a.jsx)("div",{className:"pointer-events-auto flex w-full flex-col gap-4 border-t-2 border-black/10 bg-white pb-10 pt-6",children:(0,a.jsx)("button",{className:"mx-8 flex h-[3.6rem] flex-grow items-center justify-center rounded-full bg-[#0039FF] px-4 font-bold text-white",onClick:()=>{w(e.get("tutoring_id"),e.get("lesson_id"),x)},children:j?(0,a.jsx)(i.fCD,{className:"animate-spin"}):(0,a.jsx)("p",{className:"text-lg font-medium",children:"Start"})})})})]})}},99376:function(e,t,r){"use strict";var a=r(35475);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},75478:function(e,t,r){"use strict";r.d(t,{RL:function(){return p},_g:function(){return v},eI:function(){return x}});let a=/\{[^{}]+\}/g,n=({allowReserved:e,name:t,value:r})=>{if(null==r)return"";if("object"==typeof r)throw Error("Deeply-nested arrays/objects aren’t supported. Provide your own `querySerializer()` to handle these.");return`${t}=${e?r:encodeURIComponent(r)}`},s=({allowReserved:e,explode:t,name:r,style:a,value:s})=>{if(!t){let t=(e?s:s.map(e=>encodeURIComponent(e))).join((e=>{switch(e){case"form":default:return",";case"pipeDelimited":return"|";case"spaceDelimited":return"%20"}})(a));switch(a){case"label":return`.${t}`;case"matrix":return`;${r}=${t}`;case"simple":return t;default:return`${r}=${t}`}}let l=(e=>{switch(e){case"label":return".";case"matrix":return";";case"simple":return",";default:return"&"}})(a),i=s.map(t=>"label"===a||"simple"===a?e?t:encodeURIComponent(t):n({allowReserved:e,name:r,value:t})).join(l);return"label"===a||"matrix"===a?l+i:i},l=({allowReserved:e,explode:t,name:r,style:a,value:s})=>{if(s instanceof Date)return`${r}=${s.toISOString()}`;if("deepObject"!==a&&!t){let t=[];Object.entries(s).forEach(([r,a])=>{t=[...t,r,e?a:encodeURIComponent(a)]});let n=t.join(",");switch(a){case"form":return`${r}=${n}`;case"label":return`.${n}`;case"matrix":return`;${r}=${n}`;default:return n}}let l=(e=>{switch(e){case"label":return".";case"matrix":return";";case"simple":return",";default:return"&"}})(a),i=Object.entries(s).map(([t,s])=>n({allowReserved:e,name:"deepObject"===a?`${r}[${t}]`:t,value:s})).join(l);return"label"===a||"matrix"===a?l+i:i},i=({allowReserved:e,array:t,object:r}={})=>a=>{let i=[];if(a&&"object"==typeof a)for(let o in a){let c=a[o];null!=c&&(i=Array.isArray(c)?[...i,s({allowReserved:e,explode:!0,name:o,style:"form",value:c,...t})]:"object"!=typeof c?[...i,n({allowReserved:e,name:o,value:c})]:[...i,l({allowReserved:e,explode:!0,name:o,style:"deepObject",value:c,...r})])}return i.join("&")},o=({baseUrl:e,path:t,query:r,querySerializer:i,url:o})=>{let c=e+(o.startsWith("/")?o:`/${o}`);t&&(c=(({path:e,url:t})=>{let r=t,i=t.match(a);if(i)for(let t of i){let a=!1,i=t.substring(1,t.length-1),o="simple";i.endsWith("*")&&(a=!0,i=i.substring(0,i.length-1)),i.startsWith(".")?(i=i.substring(1),o="label"):i.startsWith(";")&&(i=i.substring(1),o="matrix");let c=e[i];null!=c&&(r=Array.isArray(c)?r.replace(t,s({explode:a,name:i,style:o,value:c})):"object"!=typeof c?"matrix"!==o?r.replace(t,"label"===o?`.${c}`:c):r.replace(t,`;${n({name:i,value:c})}`):r.replace(t,l({explode:a,name:i,style:o,value:c})))}return r})({path:t,url:c}));let u=r?i(r):"";return u.startsWith("?")&&(u=u.substring(1)),u&&(c+=`?${u}`),c},c=(e,t)=>{let r={...e,...t};return r.baseUrl?.endsWith("/")&&(r.baseUrl=r.baseUrl.substring(0,r.baseUrl.length-1)),r.headers=u(e.headers,t.headers),r},u=(...e)=>{let t=new Headers;for(let r of e)if(r&&"object"==typeof r)for(let[e,a]of r instanceof Headers?r.entries():Object.entries(r))if(null===a)t.delete(e);else if(Array.isArray(a))for(let r of a)t.append(e,r);else void 0!==a&&t.set(e,"object"==typeof a?JSON.stringify(a):a);return t};class d{_fns;constructor(){this._fns=[]}eject(e){let t=this._fns.indexOf(e);-1!==t&&(this._fns=[...this._fns.slice(0,t),...this._fns.slice(t+1)])}use(e){this._fns=[...this._fns,e]}}let f={bodySerializer:e=>JSON.stringify(e)},m=(e,t,r)=>{"string"==typeof r?e.append(t,r):e.append(t,JSON.stringify(r))},p={bodySerializer:e=>{let t=new URLSearchParams;return Object.entries(e).forEach(([e,r])=>{null!=r&&(Array.isArray(r)?r.forEach(r=>m(t,e,r)):m(t,e,r))}),t}},h=i({allowReserved:!1,array:{explode:!0,style:"form"},object:{explode:!0,style:"deepObject"}}),b={"Content-Type":"application/json"},v=(e={})=>({...f,baseUrl:"",fetch:globalThis.fetch,headers:b,parseAs:"auto",querySerializer:h,...e}),x=(e={})=>{let t=c(v(),e),r=()=>({...t}),a={request:new d,response:new d},n=async e=>{let r={...t,...e,headers:u(t.headers,e.headers)};r.body&&r.bodySerializer&&(r.body=r.bodySerializer(r.body)),r.body||r.headers.delete("Content-Type");let n=new Request(o({baseUrl:r.baseUrl??"",path:r.path,query:r.query,querySerializer:"function"==typeof r.querySerializer?r.querySerializer:i(r.querySerializer),url:r.url}),{redirect:"follow",...r});for(let e of a.request._fns)n=await e(n,r);let s=r.fetch,l=await s(n);for(let e of a.response._fns)l=await e(l,n,r);let c={request:n,response:l};if(l.ok){if(204===l.status||"0"===l.headers.get("Content-Length"))return{data:{},...c};if("stream"===r.parseAs)return{data:l.body,...c};let e=("auto"===r.parseAs?(e=>{if(e)return e.startsWith("application/json")||e.endsWith("+json")?"json":"multipart/form-data"===e?"formData":["application/","audio/","image/","video/"].some(t=>e.startsWith(t))?"blob":e.startsWith("text/")?"text":void 0})(l.headers.get("Content-Type")):r.parseAs)??"json",t=await l[e]();return"json"===e&&r.responseTransformer&&(t=await r.responseTransformer(t)),{data:t,...c}}let d=await l.text();if(r.throwOnError)throw Error(d);try{d=JSON.parse(d)}catch{}return{error:d||{},...c}};return{connect:e=>n({...e,method:"CONNECT"}),delete:e=>n({...e,method:"DELETE"}),get:e=>n({...e,method:"GET"}),getConfig:r,head:e=>n({...e,method:"HEAD"}),interceptors:a,options:e=>n({...e,method:"OPTIONS"}),patch:e=>n({...e,method:"PATCH"}),post:e=>n({...e,method:"POST"}),put:e=>n({...e,method:"PUT"}),request:n,setConfig:e=>(t=c(t,e),r()),trace:e=>n({...e,method:"TRACE"})}}},46231:function(e,t,r){"use strict";r.d(t,{w_:function(){return u}});var a=r(2265),n={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},s=a.createContext&&a.createContext(n),l=["attr","size","title"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){var a,n;a=t,n=r[t],(a=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(a))in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function u(e){return t=>a.createElement(d,i({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,r)=>a.createElement(t.tag,c({key:r},t.attr),e(t.child)))}(e.child))}function d(e){var t=t=>{var r,{attr:n,size:s,title:o}=e,u=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,l),d=s||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),a.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,u,{className:r,style:c(c({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),o&&a.createElement("title",null,o),e.children)};return void 0!==s?a.createElement(s.Consumer,null,e=>t(e)):t(n)}}},function(e){e.O(0,[7240,1015,9787,8079,9677,2971,2117,1744],function(){return e(e.s=31814)}),_N_E=e.O()}]);