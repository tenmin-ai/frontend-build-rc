(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2293],{3658:function(e,t,s){Promise.resolve().then(s.bind(s,5099))},5099:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return _}});var n=s(7437),l=s(2265),i=s(4272),a=s(3974),o=s(4438),r=s(9376),c=s(9403);function d(e){let{children:t}=e,s=(0,a.useIsClient)(),{token:l}=(0,c.f)(),d=(0,r.useSearchParams)().get("session_id");return d?s?(0,n.jsx)(i.eA,{url:"".concat("wss://backend-us-rc.tenmin.ai","/ws/lesson/").concat(d,"?token=").concat(l),label:"Call",toast:o.A,autoconnect:!0,wsAuth:!0,binaryType:"arraybuffer",children:t}):null:(0,n.jsx)("div",{children:"Invalid lesson"})}var u=s(9799),x=s(755),m=s(9764);s(7354),s(6889);var h=s(3377),p=s(9677),f=s(3399),g=s(5123),j=s(1755),v=s(434),y=s(5095),b=s(5040),w=s(1273),N=s(2859),A=s(3069);let T=e=>{let{isOpen:t,onClose:s,isVoiceDetected:i,selectedMic:a,acquireMic:o}=e,[r,c]=(0,l.useState)([]),d=async()=>{c((await navigator.mediaDevices.enumerateDevices()).filter(e=>"audioinput"===e.kind))};return(0,l.useEffect)(()=>{d(),navigator.mediaDevices&&void 0!==navigator.mediaDevices.ondevicechange&&(navigator.mediaDevices.ondevicechange=d)},[]),(0,l.useEffect)(()=>{let e=setInterval(()=>{d()},1e3);return()=>clearInterval(e)},[]),(0,n.jsxs)(A.y,{isOpen:t,onClose:s,detent:"content-height",tweenConfig:{ease:"easeInOut",duration:.3},children:[(0,n.jsx)(A.y.Container,{style:{backgroundColor:"#FAFBFF"},children:(0,n.jsx)(A.y.Content,{children:(0,n.jsxs)("div",{className:"w-full p-8 pb-16 text-black",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("p",{className:"text-lg font-semibold",children:"Settings"}),(0,n.jsx)("div",{className:"flex gap-3",children:(0,n.jsx)("button",{onClick:s,children:(0,n.jsx)(w._0w,{})})})]}),(0,n.jsxs)("div",{className:"mt-6 flex flex-col gap-5",children:[(0,n.jsx)("div",{className:"flex items-center gap-2 text-black",children:(0,n.jsx)("p",{children:"Your Microphone"})}),(0,n.jsx)("div",{className:"flex flex-col gap-2",children:r.map(e=>(0,n.jsx)("button",{className:"flex w-full items-center justify-between rounded-lg border px-3 py-3 font-normal ".concat(a==e.deviceId?"border-[#0039FF] bg-[#0039FF]/5 text-[#0039FF]":"bg-white"),onClick:()=>{o(e.deviceId)},children:(0,n.jsx)("p",{className:"text-sm",children:e.label||"Unknown Microphone"})},e.deviceId))}),(0,n.jsxs)("div",{className:"mb-12 flex items-center gap-2 text-sm text-black/30",children:[(0,n.jsx)("p",{children:"Try speaking to test your microphone:"}),(0,n.jsx)("div",{className:"flex h-1 w-8 items-center justify-center rounded-full ".concat(i?"bg-green-500":"bg-black/10")})]})]})]})})}),(0,n.jsx)(A.y.Backdrop,{onTap:s})]})};var C=s(4502);let S=e=>{let{isOpen:t,onClose:s}=e;return(0,n.jsxs)(A.y,{isOpen:t,onClose:s,detent:"content-height",tweenConfig:{ease:"easeInOut",duration:.3},children:[(0,n.jsx)(A.y.Container,{style:{backgroundColor:"#FAFBFF"},children:(0,n.jsx)(A.y.Content,{children:(0,n.jsxs)("div",{className:"w-full p-8 pb-16 text-black",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("p",{className:"text-lg font-semibold",children:"Tips and tricks"}),(0,n.jsx)("div",{className:"flex gap-3",children:(0,n.jsx)("button",{onClick:s,children:(0,n.jsx)(w._0w,{})})})]}),(0,n.jsx)("div",{className:"mt-6 flex flex-col gap-5",children:(0,n.jsxs)("div",{className:"text-black",children:[(0,n.jsx)("p",{children:"Did you know that you can use your native language to ask questions?"}),(0,n.jsx)("p",{className:"mt-2 italic text-[#0039FF]/50",children:'E.g. "How do I say that I am traveling to Portugal soon?"'})]})})]})})}),(0,n.jsx)(A.y.Backdrop,{onTap:s})]})},E=e=>{let{isOpen:t,onClose:s,inputBar:l}=e;return(0,n.jsxs)(A.y,{isOpen:t,onClose:s,detent:"content-height",tweenConfig:{ease:"easeInOut",duration:.3},disableDrag:!0,children:[(0,n.jsxs)(A.y.Container,{style:{backgroundColor:"#FAFBFF",borderTopLeftRadius:"16px",borderTopRightRadius:"16px"},children:[(0,n.jsx)(A.y.Header,{}),(0,n.jsx)(A.y.Content,{children:(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center pb-16 pt-4",children:[(0,n.jsx)("p",{className:"text-lg font-semibold",children:"Speak again..."}),(0,n.jsx)("p",{className:"mb-6 mt-2 text-black/30",children:"Tap and hold the button"}),l]})})]}),(0,n.jsx)(A.y.Backdrop,{onTap:s})]})},k=e=>{let{isOpen:t,onClose:s,onQuit:l}=e;return(0,n.jsxs)(A.y,{isOpen:t,onClose:s,detent:"content-height",tweenConfig:{ease:"easeInOut",duration:.3},children:[(0,n.jsxs)(A.y.Container,{style:{backgroundColor:"#FAFBFF",borderTopLeftRadius:"16px",borderTopRightRadius:"16px"},children:[(0,n.jsx)(A.y.Header,{}),(0,n.jsx)(A.y.Content,{children:(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center px-7 pb-16 pt-4 text-center",children:[(0,n.jsx)("p",{className:"text-4xl font-semibold",children:"\uD83D\uDE2D"}),(0,n.jsx)("p",{className:"mt-4 text-lg font-semibold",children:"Quit and you'll lose all XP gained in this lesson!"}),(0,n.jsx)("button",{className:"mt-8 flex w-full items-center justify-center rounded-full bg-[#0039FF] py-4 text-white",onClick:()=>{s()},children:(0,n.jsx)("p",{className:"text-base font-bold",children:"Keep learning"})}),(0,n.jsx)("button",{className:"mt-2 flex w-full items-center justify-center py-4 font-semibold text-red-600",onClick:()=>{l()},children:"Quit"})]})})]}),(0,n.jsx)(A.y.Backdrop,{onTap:s})]})};var F=s(6593),P=s(3344);let D=e=>{var t;let{isOpen:s,onClose:l,onFinish:i,streakPlus:o,xp:c,words:d,minutes:u}=e,m=(0,r.useRouter)(),[h,p]=(0,a.useLocalStorage)("language"),{data:f,isLoading:g}=(0,F.a)({...(0,P.rs)({query:{language:h}})}),j=Object.entries(f||{});j.length>0&&(null===(t=j[0][1])||void 0===t||t.streak);let v={hidden:{opacity:0,scale:.8},visible:{opacity:1,scale:1,transition:{duration:.5}}};return(0,n.jsxs)(A.y,{isOpen:s,onClose:l,detent:"content-height",tweenConfig:{ease:"easeInOut",duration:.3},children:[(0,n.jsxs)(A.y.Container,{style:{backgroundColor:"#FAFBFF",borderTopLeftRadius:"16px",borderTopRightRadius:"16px"},children:[(0,n.jsx)(A.y.Header,{}),(0,n.jsx)(A.y.Content,{children:(0,n.jsx)("main",{className:"flex flex-col bg-[#FAFBFF] pb-10 tracking-[-0.02em]",children:(0,n.jsxs)("div",{className:"flex h-full flex-col justify-between px-8",children:[(0,n.jsxs)("div",{className:"flex h-full flex-col items-center justify-center",children:[(0,n.jsxs)(x.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.3},className:"flex h-[10.75rem] flex-col items-center justify-center gap-5",children:[(0,n.jsx)(x.E.div,{initial:{y:-20},animate:{y:0},transition:{delay:.1,type:"spring",stiffness:300},className:"flex gap-2",children:[0,1,2].map(e=>(0,n.jsx)(x.E.div,{initial:{opacity:0,rotate:-180},animate:{opacity:1,rotate:0},transition:{delay:.1*e,duration:.3},children:(0,n.jsx)(w.QJe,{className:"text-4xl text-[#FFC800] ".concat(1==e&&"-translate-y-3")})},e))}),(0,n.jsx)(x.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.3},className:"mt-2 text-center text-xl font-semibold",children:"Lesson complete!"})]},"encouragement"),(0,n.jsxs)("div",{className:"mt-0 grid w-full grid-cols-3 gap-2",children:[(0,n.jsxs)(x.E.div,{className:"flex flex-col items-center justify-center rounded-xl border-[1px] border-[#DADADA] bg-white py-4",variants:v,initial:"hidden",animate:"visible",children:[(0,n.jsx)(w.LkT,{className:"text-xl text-[#FFC800]"}),(0,n.jsx)("div",{className:"mt-2 text-lg font-medium",children:c}),(0,n.jsx)("div",{className:"text-xs text-black/30",children:"XP"})]}),(0,n.jsxs)(x.E.div,{className:"flex flex-col items-center justify-center rounded-xl border-[1px] border-[#DADADA] bg-white py-4",variants:v,initial:"hidden",animate:"visible",children:[(0,n.jsx)(w.ml,{className:"text-xl text-[#CD348E]"}),(0,n.jsx)("div",{className:"mt-2 text-lg font-medium",children:d}),(0,n.jsx)("div",{className:"text-xs text-black/30",children:"Words"})]}),(0,n.jsxs)(x.E.div,{className:"flex flex-col items-center justify-center rounded-xl border-[1px] border-[#DADADA] bg-white py-4",variants:v,initial:"hidden",animate:"visible",children:[(0,n.jsx)(w.qyc,{className:"text-xl text-[#34CD71]"}),(0,n.jsx)("div",{className:"mt-2 text-lg font-medium",children:u}),(0,n.jsx)("div",{className:"text-xs text-black/30",children:"Minutes"})]})]})]}),(0,n.jsx)("button",{className:"mt-8 flex w-full items-center justify-center rounded-full bg-[#0039FF] py-4 text-white",onClick:()=>{i(),o?m.push("/streakPlus"):m.push("/")},children:(0,n.jsx)("p",{className:"text-base font-semibold",children:"Finish lesson"})}),(0,n.jsx)("button",{className:"mt-2 flex w-full items-center justify-center py-4 font-semibold text-[#0039FF]",onClick:()=>{l()},children:"Continue conversation"})]})})})]}),(0,n.jsx)(A.y.Backdrop,{onTap:l})]})};function R(){var e,t,s,a,o,c,d,A;let F=(0,r.useSearchParams)().get("session_id"),{startRecording:P,stopRecording:R,playRecording:_,stopPlayback:O,isPracticeRecording:I,isPlayingAudio:L}=(0,j.I)(),[M,B]=(0,l.useState)(0),[V,W]=(0,l.useState)(!1),[Q,H]=(0,l.useState)(0),[G,q]=(0,l.useState)(null),[U,Y]=(0,l.useState)(""),[K,J]=(0,l.useState)(null),X=(0,i.MV)("AUDIO_CALL",{status:"BACKEND_DISCONNECTED",mode:"Beginner",showStreakPlus:!1,xp:0,startTime:new Date().toISOString(),speedPreference:"NORMAL",lessonInfo:{},saved:[]}),z=(0,i.MV)("STT",{requirePcm:void 0,totalTranscript:"",currTranscript:"",tempTranscript:""}),Z=(0,i.MV)("CHAT",{messages:[],userPreview:null,assistantPreview:null}),$=(0,i.MV)("TTS",{volumeMultiplier:1}),[ee]=(0,l.useState)(1);(0,l.useEffect)(()=>((async()=>{try{await g.P.keepAwake()}catch(e){console.error("Failed to enable keep-awake",e)}})(),()=>{(async()=>{await g.P.allowSleep()})()}),[]);let{startSpeaker:et,isPlaying:es,latestAudioId:en,latestCharIndex:el,setLatestAudioId:ei}=(0,f.Z)({onPlaybackChange:(e,t)=>{$.sendAction({type:e?"PLAYBACK_STARTED":"PLAYBACK_FINISHED",id:t})},volume:$.volumeMultiplier,speed:ee}),ea=(e,t)=>void 0==e||null==el?"":t?t.length>0?e.slice(0,el*e.length/t.length):e:e.slice(0,el),[eo,er]=(0,l.useState)(!1),ec=(0,r.useRouter)(),[ed,eu]=(0,l.useState)(!0),[ex,em]=(0,l.useState)(!0),[eh,ep]=(0,l.useState)(!1),[ef,eg]=(0,l.useState)(null),[ej,ev]=(0,l.useState)(!1),[ey,eb]=(0,l.useState)(!1),{isVoiceDetected:ew,isRecording:eN,isMuted:eA,setMuted:eT,selectedMic:eC,startRecording:eS,stopRecording:eE,cancelRecording:ek,acquireMic:eF}=(0,p.Z)({onAudioData:e=>{if(!z.requirePcm){if(0==e.byteLength){console.warn("Empty audio blob received");return}z.sendBinary({type:"STREAM_MIC"},e)}},onPCMData(e){if(z.requirePcm){if(0===e.byteLength){console.warn("Empty pcm data received");return}z.sendBinary({type:"STREAM_PCM"},e)}},onRecordingStart:()=>{"Realtime"!=X.mode&&z.sendAction({type:"PTT_PRESSED"})},onRecordingStop:e=>{"Realtime"!=X.mode&&(e?z.sendAction({type:"PTT_CANCELLED"}):z.sendAction({type:"PTT_RELEASED"}))},onSpeechStart:()=>{z.sendAction({type:"VAD_CHANGED",detected:!0})},onSpeechEnd:()=>{z.sendAction({type:"VAD_CHANGED",detected:!1})},startMuted:!1,recordingChunkSize:100}),eP=parseInt(null!==(A=null==en?void 0:en.slice(1))&&void 0!==A?A:"")>=Z.messages.length,eD=(0,l.useMemo)(()=>Z.messages.concat(Z.userPreview?[{role:"user",content:Z.userPreview,tool_calls:null}]:[]).concat(Z.assistantPreview&&eP?[{role:"assistant",content:Z.assistantPreview,tool_calls:null}]:[]),[Z.messages,Z.userPreview,Z.assistantPreview,eP]),eR=(0,i.MV)("TRANSLATION",{wordForWord:{},translations:{}}),[e_]=(0,i.tp)("CORRECTION",(e,t)=>{if("PERFECT"===t.type){if("Advanced"!==X.mode&&W(!0),!es&&!eN&&!I){let e=new Audio("encouragement.mp3");e.volume=.5,e.play()}setTimeout(()=>{W(!1)},1200)}},{corrections:{}}),eO=(0,i.MV)("AUTOCOMPLETE",{suggestions:[],translations:[],wordForWord:[],saved:[]}),eI=(0,l.useRef)(null),eL=(0,l.useRef)(null),[eM,eB]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let e=()=>{if(eL.current){let{scrollTop:e,scrollHeight:t,clientHeight:s}=eL.current;e+s>=t&&eB(!1)}},t=eL.current;return t&&t.addEventListener("scroll",e),()=>{t&&t.removeEventListener("scroll",e)}},[]),(0,l.useEffect)(()=>{if(eM)return;eI.current&&cancelAnimationFrame(eI.current);let e=document.getElementById("CHAT_BOTTOM");return e&&(eI.current=requestAnimationFrame(()=>{e.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})})),()=>{eI.current&&cancelAnimationFrame(eI.current)}},[eD,eR]),(0,l.useEffect)(()=>{B(eD.length/12),1==M&&eb(!0)},[eD]),(0,l.useEffect)(()=>{"CONNECTED"!=X.status&&"BACKEND_DISCONNECTED"!=X.status&&(eo||(console.log("Auto starting lesson"),er(!0),et(()=>{X.sendAction({type:"START_CALL"})},()=>{alert("Failed to start speaker")}),"Realtime"==X.mode&&eS(),eT(!1)))},[X.status]);let[eV,eW]=(0,l.useState)(!1);return(0,n.jsxs)("div",{className:"flex h-full flex-col items-center tracking-[-0.02em]",children:[(0,n.jsx)(y.e,{isOpen:null!==G,onClose:()=>{H(0),q(null),J(null)},detailedTranslation:"message"===G?{wordForWord:eR.wordForWord[Q],translation:eR.translations[Q]}:{wordForWord:eO.wordForWord[Q],translation:eO.translations[Q]},isTTSPlaying:es&&"e"==en,onTTSPlay:e=>{et(),U&&$.sendAction({type:"SAY",text_stream:null!=e?e:U,id:"e"})},isPracticeRecording:I,setPracticeRecording:e=>{e?P():R()},isPracticePlaying:L,setPracticePlaying:e=>{e?_():O()},onSave:null!=K?K:void 0,isSaved:"message"===G?X.saved[Q]:"suggestion"===G?eO.saved[Q]:void 0}),(0,n.jsx)(T,{isOpen:eV,onClose:()=>{eW(!1)},isVoiceDetected:ew,selectedMic:eC,acquireMic:eF}),(0,n.jsx)(E,{isOpen:null!==ef,onClose:()=>{eg(null)},inputBar:(0,n.jsx)(C.y,{onStartPress:()=>{eS(),eT(!1)},onEndPress:()=>{if(null===ef){console.error("Redo message index is null");return}Z.sendAction({type:"RESET_TO_MESSAGE",index:ef}),ei("l".concat(ef-1)),eE(),et(),eB(!1),setTimeout(()=>{eg(null)},100)},onCancel:()=>{ek()}})}),(0,n.jsx)(S,{isOpen:eh,onClose:()=>ep(!1)}),(0,n.jsx)(D,{isOpen:ey,onClose:()=>eb(!1),onFinish:()=>{X.sendAction({type:"STOP_CALL"})},streakPlus:X.showStreakPlus,xp:X.xp,words:eD.filter(e=>"user"===e.role).reduce((e,t)=>e+t.content.split(" ").length,0),minutes:Math.ceil((new Date().getTime()-new Date(X.startTime).getTime())/1e3/60)}),(0,n.jsx)(k,{isOpen:ej,onClose:()=>ev(!1),onQuit:()=>{X.sendAction({type:"STOP_CALL"}),ec.back()}}),(0,n.jsx)("div",{className:"flex w-full flex-col items-center px-7 pb-2",children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-between px-1",children:[(0,n.jsx)("button",{className:"flex h-12 items-center justify-center self-start rounded-full text-black",onClick:()=>{console.log("audioCall.showStreakPlus",X.showStreakPlus),er(!1),M>=1?eb(!0):ev(!0)},children:(0,n.jsx)(w._0w,{className:"text-xl"})}),(0,n.jsx)("div",{className:"mx-5 h-1.5 flex-grow overflow-hidden rounded-full bg-[#D9D9D9]",children:(0,n.jsx)("div",{className:"h-full rounded-full bg-[#0039FF] transition-all duration-300 ease-out",style:{width:"".concat(100*M,"%")}})}),(0,n.jsx)("button",{className:"flex h-12 items-center justify-center self-start rounded-full text-black/30",onClick:()=>{eW(!0)},children:(0,n.jsx)(w.kvo,{className:"text-xl"})})]})}),(0,n.jsxs)("div",{className:"w-full flex-grow overflow-auto overscroll-contain px-7 pt-1",onTouchStart:()=>eB(!0),ref:eL,children:[eD.length>0&&"Realtime"!==X.mode&&eD.map((e,t)=>{var s,l;let i=es&&"r".concat(t.toString())==en,a=eP&&"l".concat(t.toString())==en,o=i||a;if((null==e?void 0:e.role)==="assistant")return(0,n.jsxs)("div",{children:[(0,n.jsx)(b.nQ,{profilePicture:null===(l=X.lessonInfo)||void 0===l?void 0:null===(s=l.tutor)||void 0===s?void 0:s.profile_picture_url,isPlaying:o,message:"Advanced"!=X.mode&&ex?o?ea(e.content):e.content:void 0,translation:"Advanced"!=X.mode&&ex?o?ea(eR.translations[t],e.content):eR.translations[t]:void 0,onTap:()=>{a||(eR.sendAction({type:"REQUEST_WORD_FOR_WORD",index:t}),Y(e.content),H(t),q("message"),J(()=>e=>{X.sendAction({type:e?"DELETE_MESSAGE":"SAVE_MESSAGE",index:t})}))},onTTSPlay:()=>{et(),$.sendAction({type:"SAY",text_stream:null==e?void 0:e.content,id:"r".concat(t)})},onTTSStop:()=>{et(),$.sendAction({type:"STOP",id:"r".concat(t)})},onTranslate:e=>{e&&(eR.translations[t]||eR.sendAction({type:"REQUEST_TRANSLATION",index:t}))},defaultShowTranslation:"Beginner"==X.mode}),e.tool_calls&&(0,n.jsx)(b.TH,{message:JSON.parse(e.tool_calls[0].function.arguments).text,onTap:()=>{}},t)]},t);if((null==e?void 0:e.role)==="user"){let s=e_.corrections[t];return(0,n.jsx)(b.MI,{message:e.content,translation:eR.translations[t],correction:s,onTap:()=>{a||(eR.sendAction({type:"REQUEST_WORD_FOR_WORD",index:t}),Y(e.content),H(t),q("message"),J(()=>()=>{X.sendAction({type:"SAVE_MESSAGE",index:t})}))},onTranslate:e=>{e&&(eR.translations[t]||eR.sendAction({type:"REQUEST_TRANSLATION",index:t}))},onRedo:()=>{eg(t)},defaultShowTranslation:"Beginner"==X.mode},t)}}),"Realtime"==X.mode&&(0,n.jsxs)("div",{className:"flex h-full flex-col items-center justify-center",children:[(0,n.jsxs)("div",{className:"mb-16 flex w-full flex-col items-center gap-2 rounded-xl border-[1px] border-black/10 bg-white py-6",children:[(0,n.jsx)("img",{src:null===(t=X.lessonInfo)||void 0===t?void 0:null===(e=t.tutor)||void 0===e?void 0:e.profile_picture_url,alt:"",className:"h-20 w-20"}),(0,n.jsx)("div",{className:"text-lg font-medium",children:null===(a=X.lessonInfo)||void 0===a?void 0:null===(s=a.lesson)||void 0===s?void 0:s.title}),(0,n.jsx)("div",{className:"text-3xl",children:null===(c=X.lessonInfo)||void 0===c?void 0:null===(o=c.lesson)||void 0===o?void 0:o.emoji}),(0,n.jsx)("div",{className:"rounded-md bg-[#0039FF]/10 p-2 text-[#0039FF]",children:"Real time call"})]}),(0,n.jsx)("div",{className:"mx-8 text-center text-sm text-black/30",children:"Caution: This mode is experimental and may not work as expected."})]}),(0,n.jsx)("div",{id:"CHAT_BOTTOM"})]}),(0,n.jsx)("div",{className:"pointer-events-none w-full justify-end gap-5 tracking-[-0.02em]",children:(0,n.jsxs)("div",{className:"pointer-events-auto flex w-full flex-col gap-4 pb-10 pt-4 ".concat("Realtime"==X.mode?"":"border-t-[1px] border-black/10 bg-white"),children:[(0,n.jsx)(u.M,{mode:"wait",children:V&&!eN?(0,n.jsxs)(x.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.3},className:"flex h-[10.75rem] flex-col items-center justify-center gap-5",children:[(0,n.jsx)(x.E.div,{initial:{y:-20},animate:{y:0},transition:{delay:.1,type:"spring",stiffness:300},className:"flex gap-2",children:[0,1,2].map(e=>(0,n.jsx)(x.E.div,{initial:{opacity:0,rotate:-180},animate:{opacity:1,rotate:0},transition:{delay:.1*e,duration:.3},children:(0,n.jsx)(w.QJe,{className:"text-[#0039FF]"})},e))}),(0,n.jsx)(x.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.3},children:"Amazing \uD83E\uDD73"})]},"encouragement"):eD.length>0&&"Realtime"!==X.mode&&"Advanced"!==X.mode?(0,n.jsxs)(x.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:[(0,n.jsx)("div",{className:"mb-1 flex justify-center text-base font-light text-black/30",onClick:()=>{eu(!ed)},children:(0,n.jsx)(x.E.div,{animate:{rotateX:ed?0:180},transition:{duration:.6,ease:"easeInOut"},children:(0,n.jsx)(w.RiI,{className:"scale-y-75 transform"})})}),(0,n.jsx)(u.M,{children:ed&&(0,n.jsx)(x.E.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut",opacity:{duration:.05,ease:"easeInOut"},height:{duration:.3,ease:"easeInOut"}},className:"overflow-hidden",children:(0,n.jsx)("div",{className:"h-32",children:(0,n.jsx)(m.tq,{pagination:!0,modules:[h.tl],className:"w-screen bg-white",children:(null===(d=eO.suggestions)||void 0===d?void 0:d.length)>=3?eO.suggestions.map((e,t)=>(0,n.jsx)(m.o5,{className:"mb-4 !h-auto px-6 py-2",children:(0,n.jsxs)("button",{onClick:()=>{Y(e),H(t),q("suggestion"),J(()=>e=>{console.log("saving suggestion"),eO.sendAction({type:e?"DELETE_SUGGESTION":"SAVE_SUGGESTION",index:t})})},className:"flex h-full w-full flex-col items-center rounded-lg bg-white p-4 shadow-custom-shadow",children:["Intermediate"===X.mode||"Advanced"===X.mode?(0,n.jsx)("div",{className:"flex flex-wrap gap-1 gap-y-5",children:eO.wordForWord[t]&&eO.wordForWord[t].length>0&&eO.wordForWord[t].map((e,t)=>(0,n.jsx)("div",{className:"flex flex-col items-center",children:(0,n.jsx)("div",{className:"mb-1 text-nowrap rounded-sm bg-black/5 px-1 font-normal text-black/0",children:e.original})},t))}):(0,n.jsx)("div",{className:"w-full overflow-hidden overflow-ellipsis whitespace-nowrap",children:(0,v.f)(e)}),(0,n.jsx)("div",{className:"w-full overflow-hidden overflow-ellipsis whitespace-nowrap text-sm text-black/30",children:(0,v.f)(eO.translations[t])})]})},t)):(0,n.jsx)(n.Fragment,{children:Array.from({length:3}).map((e,t)=>(0,n.jsx)(m.o5,{className:"mb-4 !h-auto px-6 py-2",children:(0,n.jsx)("div",{className:"h-full w-full rounded-lg bg-white p-4 shadow-custom-shadow",children:(0,n.jsxs)("div",{className:"flex w-full flex-col items-center space-y-2",children:[(0,n.jsx)("div",{className:"animate-shimmer h-5 w-2/3 rounded bg-gray-200"}),(0,n.jsx)("div",{className:"animate-shimmer h-5 w-2/3 rounded bg-gray-200"})]})})},t))})})})})})]},"messages"):null}),"CONNECTED"!==X.status?(0,n.jsx)("button",{className:"mx-8 flex h-[3.6rem] flex-grow items-center justify-center rounded-full bg-[#0039FF] px-4 font-bold text-white",onClick:()=>{eo||(er(!0),et(()=>{X.sendAction({type:"START_CALL"})},()=>{alert("Failed to start speaker")}),"Realtime"==X.mode&&eS(),eT(!1))},children:(0,n.jsx)(w.fCD,{className:"animate-spin"})}):"Realtime"==X.mode?(0,n.jsxs)("div",{className:"mx-8 flex w-full items-center justify-between",children:[(0,n.jsxs)("button",{className:"relative flex h-14 w-14 items-center justify-center rounded-full bg-black/5 ".concat(ew?"ring-4":""," ").concat(eA?"ring-red-500/70":"ring-green-500/70"),onClick:()=>{et(),eN||eS(),eT(!eA)},children:[(0,n.jsx)(N.J,{icon:eA?w.uYL:w.RgM,className:"text-xl text-black"}),ew&&eA&&(0,n.jsx)("p",{className:"absolute -right-[120px] -top-8 rounded-full rounded-bl-none bg-black/5 p-2 text-sm",children:"Press to unmute"})]}),(0,n.jsx)("button",{className:"flex h-14 w-14 items-center justify-center rounded-full bg-black/5",onClick:()=>{er(!1),X.sendAction({type:"STOP_CALL"}),console.log("audioCall.showStreakPlus",X.showStreakPlus),ec.push("/feedback?session_id=".concat(F))},children:(0,n.jsx)(w._0w,{className:"text-xl text-black"})})]}):(0,n.jsx)(C.y,{onStartPress:()=>{eS(),eT(!1)},onEndPress:()=>{eE(),et(),eB(!1)},onCancel:()=>{ek()},viewText:ex,setViewText:em,viewQuestion:eh,setViewQuestion:ep})]})})]})}function _(){return(0,n.jsx)(d,{children:(0,n.jsx)("main",{className:"h-screen-safe bg-[#FAFBFF] pt-1",children:(0,n.jsx)(R,{})})})}}},function(e){e.O(0,[2284,7240,1015,6051,6491,1649,755,9787,4272,3069,4438,8046,3344,3864,3386,2971,2117,1744],function(){return e(e.s=3658)}),_N_E=e.O()}]);