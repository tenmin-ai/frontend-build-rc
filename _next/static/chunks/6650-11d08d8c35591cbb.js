"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6650],{33344:function(i,t,e){e.d(t,{GI:function(){return l},PA:function(){return g},ax:function(){return d},bi:function(){return c},iy:function(){return s},rs:function(){return h}});var a=e(52274),n=e(19856);let r=(i,t,e)=>{var a;let r={_id:i,baseUrl:(null!==(a=null==t?void 0:t.client)&&void 0!==a?a:n.Lp).getConfig().baseUrl};return e&&(r._infinite=e),(null==t?void 0:t.body)&&(r.body=t.body),(null==t?void 0:t.headers)&&(r.headers=t.headers),(null==t?void 0:t.path)&&(r.path=t.path),(null==t?void 0:t.query)&&(r.query=t.query),r},s=()=>({mutationFn:async i=>{let{data:t}=await (0,n.H4)({...i,throwOnError:!0});return t}}),o=i=>[r("userMyData",i)],l=i=>(0,a.C)({queryFn:async t=>{let{queryKey:e}=t,{data:a}=await (0,n.It)({...i,...e[0],throwOnError:!0});return a},queryKey:o(i)}),d=()=>({mutationFn:async i=>{let{data:t}=await (0,n._5)({...i,throwOnError:!0});return t}}),c=()=>({mutationFn:async i=>{let{data:t}=await (0,n._G)({...i,throwOnError:!0});return t}}),u=i=>[r("tutoringGetAll",i)],h=i=>(0,a.C)({queryFn:async t=>{let{queryKey:e}=t,{data:a}=await (0,n.zW)({...i,...e[0],throwOnError:!0});return a},queryKey:u(i)}),v=i=>[r("tutoringGetLeaderboard",i)],g=i=>(0,a.C)({queryFn:async t=>{let{queryKey:e}=t,{data:a}=await (0,n.Vz)({...i,...e[0],throwOnError:!0});return a},queryKey:v(i)})},49677:function(i,t,e){e.d(t,{Z:function(){return s}});var a=e(2265),n=e(9800);class r{init(){if(this.isInitialized){console.warn("MicManager: already initialized");return}if(this.initializing){console.warn("MicManager: already initializing");return}this.initializing=this._init()}async _init(){var i;for(let t of(console.log("MicManager init start...",this),this.mediaStream=await navigator.mediaDevices.getUserMedia({audio:{deviceId:null!==(i=this.selectedMicId)&&void 0!==i?i:void 0,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:16e3}}),this.mediaStream.getAudioTracks()))t.enabled=!this.isMuted;this.mediaRecorder=new MediaRecorder(this.mediaStream),await this.initVad(),this.isInitialized=!0,this.initializing=null,console.log("MicManager init complete.")}async initVad(){let i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.mediaStream){console.warn("MicManager: no mediaStream to initVad");return}if(this.vad&&!i){console.warn("MicManager: vad already initialized");return}this.vad&&(console.warn("MicManager: vad already initialized, but forcing re-init"),this.destroyVad()),this.vad=await n.MicVAD.new({baseAssetPath:"/vad/",onnxWASMBasePath:"/vad/",stream:this.mediaStream,onSpeechStart:()=>{var i;this.isVoiceDetected=!0,null===(i=this.onSpeechStart)||void 0===i||i.call(this)},onVADMisfire:()=>{var i;this.isVoiceDetected=!1,null===(i=this.onSpeechEnd)||void 0===i||i.call(this,!0)},onSpeechEnd:()=>{var i;this.isVoiceDetected=!1,null===(i=this.onSpeechEnd)||void 0===i||i.call(this,!1)},onFrameProcessed:(i,t)=>{var e,a;this.lastPCMTimestamp=Date.now();let n=new ArrayBuffer(2*t.length),r=new DataView(n);for(let i=0;i<t.length;i++)r.setInt16(2*i,32767*t[i],!0);null===(e=this.onAlwaysPCMData)||void 0===e||e.call(this,n),this.capturingPCM&&(null===(a=this.onPCMData)||void 0===a||a.call(this,n))}}),this.vad.start()}destroyVad(){this.vad?(this.vad.destroy(),this.vad=null,this.lastPCMTimestamp=null):console.warn("MicManager: no vad to destroy")}async ensureVad(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;this.vad&&this.lastPCMTimestamp&&Date.now()-this.lastPCMTimestamp<i||(console.warn("MicManager: vad is broken, re-initializing..."),await this.initVad(!0))}startPCM(){this.capturingPCM=!0}stopPCM(){this.capturingPCM=!1}setMuted(){var i;let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.isMuted!==t&&(this.ensureVad(),this.isMuted=t,null===(i=this.mediaStream)||void 0===i||i.getAudioTracks().forEach(i=>{i.enabled=!t}))}startRecording(){if(this.mediaRecorder||console.warn("MicManager: no mediaRecorder to start"),this.isRecording){console.warn("MicManager: already recording");return}this.ensureVad(),this.isRecording=!0,this.wasCancelled=!1,this.startPCM(),this.mediaRecorder&&(this.mediaRecorder.ondataavailable=i=>{this.lastDataAvailablePromise=(async()=>{var t;let e=await i.data.arrayBuffer();null===(t=this.onAudioData)||void 0===t||t.call(this,e)})()},this.mediaRecorder.onstart=()=>{var i;null===(i=this.onRecordingStart)||void 0===i||i.call(this)},this.mediaRecorder.onstop=async()=>{var i;this.lastDataAvailablePromise&&await this.lastDataAvailablePromise,this.isRecording=!1,null===(i=this.onRecordingStop)||void 0===i||i.call(this,this.wasCancelled)},this.mediaRecorder.start(this.recordingChunkSize))}stopRecording(){var i;this.isRecording&&(this.ensureVad(),this.stopPCM(),null===(i=this.mediaRecorder)||void 0===i||i.stop())}cancelRecording(){this.isRecording&&(this.ensureVad(),this.wasCancelled=!0,this.stopRecording())}async destroy(){if(!this.isInitialized&&!this.initializing){console.warn("MicManager: not initialized nor initializing");return}if(this.initializing&&(console.info("MicManager: still initializing, waiting..."),await this.initializing),console.log("MicManager: destroying..."),this.destroyVad(),this.mediaRecorder&&(this.mediaRecorder.stop(),this.mediaRecorder.ondataavailable=null,this.mediaRecorder.onstop=null,this.mediaRecorder.onstart=null,this.mediaRecorder=null),this.mediaStream&&(this.mediaStream.getTracks().forEach(i=>i.stop()),this.mediaStream=null),this.isVoiceDetected){var i;this.isVoiceDetected=!1,null===(i=this.onSpeechEnd)||void 0===i||i.call(this,!1)}this.isRecording=!1,this.wasCancelled=!1,this.capturingPCM=!1,this.isInitialized=!1,console.log("MicManager: destroyed")}constructor({recordingChunkSize:i=100,selectedMicId:t=null,onSpeechStart:e,onSpeechEnd:a,onAlwaysPCMData:n,onPCMData:r,onAudioData:s,onRecordingStart:o,onRecordingStop:l}){this.mediaStream=null,this.mediaRecorder=null,this.vad=null,this.isMuted=!1,this.isRecording=!1,this.wasCancelled=!1,this.isVoiceDetected=!1,this.capturingPCM=!1,this.lastPCMTimestamp=null,this.lastDataAvailablePromise=null,this.isInitialized=!1,this.initializing=null,this.recordingChunkSize=i,this.selectedMicId=t,this.onSpeechStart=e,this.onSpeechEnd=a,this.onAlwaysPCMData=n,this.onPCMData=r,this.onAudioData=s,this.onRecordingStart=o,this.onRecordingStop=l}}function s(i){let{startMuted:t=!1,recordingChunkSize:e=100,onSpeechStart:n,onSpeechEnd:s,onAlwaysPCMData:o,onPCMData:l,onAudioData:d,onRecordingStart:c,onRecordingStop:u}=i,[h,v]=(0,a.useState)("AirPods"),[g,M]=(0,a.useState)(!1),[f,m]=(0,a.useState)(!1),[R,w]=(0,a.useState)(t),y=(0,a.useRef)(null),p=(0,a.useRef)(n),S=(0,a.useRef)(s),C=(0,a.useRef)(o),P=(0,a.useRef)(l),D=(0,a.useRef)(d),E=(0,a.useRef)(c),z=(0,a.useRef)(u);return(0,a.useEffect)(()=>{p.current=n},[n]),(0,a.useEffect)(()=>{S.current=s},[s]),(0,a.useEffect)(()=>{C.current=o},[o]),(0,a.useEffect)(()=>{P.current=l},[l]),(0,a.useEffect)(()=>{D.current=d},[d]),(0,a.useEffect)(()=>{E.current=c},[c]),(0,a.useEffect)(()=>{z.current=u},[u]),(0,a.useEffect)(()=>{let i=new r({selectedMicId:h,recordingChunkSize:e,onSpeechStart:()=>{var i;m(!0),null===(i=p.current)||void 0===i||i.call(p)},onSpeechEnd:i=>{var t;m(!1),null===(t=S.current)||void 0===t||t.call(S,i)},onAlwaysPCMData:i=>{var t;null===(t=C.current)||void 0===t||t.call(C,i)},onPCMData:i=>{var t;null===(t=P.current)||void 0===t||t.call(P,i)},onAudioData:i=>{var t;null===(t=D.current)||void 0===t||t.call(D,i)},onRecordingStart:()=>{var i;M(!0),null===(i=E.current)||void 0===i||i.call(E)},onRecordingStop:i=>{var t;M(!1),null===(t=z.current)||void 0===t||t.call(z,i)}});return y.current=i,i.init(),()=>{i.destroy(),y.current=null}},[h]),(0,a.useEffect)(()=>{var i;null===(i=y.current)||void 0===i||i.setMuted(R)},[R]),{isMuted:R,isRecording:g,isVoiceDetected:f,selectedMic:h,acquireMic:function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;v(i)},setMuted:w,startRecording:()=>{var i;null===(i=y.current)||void 0===i||i.startRecording()},stopRecording:()=>{var i;return null===(i=y.current)||void 0===i?void 0:i.stopRecording()},cancelRecording:()=>{var i;return null===(i=y.current)||void 0===i?void 0:i.cancelRecording()}}}},89403:function(i,t,e){e.d(t,{f:function(){return n}});var a=e(53974);let n=()=>{let[i,t]=(0,a.useLocalStorage)("token");return{token:i,saveToken:t}}}}]);