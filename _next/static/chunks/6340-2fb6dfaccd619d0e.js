"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6340],{5040:function(e,t,n){n.d(t,{MI:function(){return u},nQ:function(){return o}});var r=n(7437),l=n(2265),c=n(1273),s=n(2744),a=n(434),i=n(2859);let o=e=>{let{profilePicture:t,message:n,translation:c,isPlaying:o=!1,onTap:u,onTTSPlay:d,onTTSStop:x,onTranslate:m,defaultShowTranslation:f=!0}=e,[g,h]=(0,l.useState)(f);return(0,r.jsxs)("div",{className:"bg-white rounded-tl-none rounded-lg py-4 px-4 mb-8 ring-1 ring-black/10 mr-14",onClick:u,children:["string"==typeof t?(0,r.jsx)("img",{src:t,className:"w-7 h-7 mb-3 rounded-full"}):t,(0,r.jsx)("div",{className:"font-medium",children:void 0===n?(0,r.jsxs)("div",{className:"flex flex-col gap-2 mb-4",children:[(0,r.jsx)("div",{className:"h-2 bg-gray-200 rounded-full w-full"}),(0,r.jsx)("div",{className:"h-2 bg-gray-200 rounded-full w-2/3"})]}):(0,a.f)(n)}),g&&(0,r.jsx)("div",{className:"text-black/30 text-sm",children:c}),(0,r.jsxs)("div",{className:"mt-2 flex gap-2",children:[d&&(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),o?null==x||x():d()},children:(0,r.jsx)(i.J,{icon:o?s.H6t:s.hwG,className:"text-black/30 text-xl"})}),m&&(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),m(!g),h(!g)},children:(0,r.jsx)(s.mp2,{className:"text-black/30 text-xl"})})]})]})},u=e=>{let t,n,a,{message:i,translation:o,correction:u,onTap:d,onTranslate:x,defaultShowTranslation:m=!0}=e,[f,g]=(0,l.useState)(m),h="flex-initial bg-[#0039FF]/5 ring-1 rounded-lg py-4 px-4 ring-[#0039FF]/20 rounded-tr-none";u?"Grammar"===u.mistake||"Phrasing"===u.mistake?(t=(0,r.jsx)("div",{className:"font-normal text-red-600 line-through",children:i}),n=(0,r.jsx)("div",{className:"text-green-600",children:u.correct_version})):"No Mistake"===u.mistake?(h="relative flex-initial bg-green-500/5 ring-1 rounded-lg py-4 px-4 ring-green-600/20 rounded-tr-none",t=(0,r.jsx)("div",{className:"font-normal text-green-600",children:i}),a=(0,r.jsx)(c.ETl,{className:"absolute -right-2 -bottom-2 text-green-600 text-xl"})):t=(0,r.jsx)("div",{className:"font-normal",children:i}):t=(0,r.jsx)("div",{className:"font-normal",children:i});let v=o&&f&&(0,r.jsx)("div",{className:"text-black/30 text-sm",children:o});return(0,r.jsxs)("div",{className:"flex flex-wrap-reverse justify-end items-center mb-8 ml-14 gap-y-3",children:[u&&u.explanation&&(0,r.jsxs)("div",{className:"basis-32 grow text-xs -ml-10 mr-3",children:[(0,r.jsxs)("p",{className:"font-bold",children:[u.mistake,(0,r.jsx)(c.EQK,{className:"mx-1 inline-block"})]}),(0,r.jsx)("p",{className:"italic",children:u.explanation})]}),(0,r.jsxs)("div",{className:h,onClick:d,children:[t,n,v,(0,r.jsx)("div",{className:"mt-2 flex gap-2",children:x&&(0,r.jsx)(s.mp2,{className:"text-black/30 !text-xl",onClick:e=>{e.stopPropagation(),x(!f),g(!f)}})}),a]})]})};t.ZP=u},8171:function(e,t,n){n.d(t,{y:function(){return i}});var r=n(7437),l=n(2265),c=e=>{let{onStartPress:t,onEndPress:n,onCancel:c,cancelButtonRef:s,children:a}=e,[i,o]=(0,l.useState)(!1),u=(0,l.useRef)({x:0,y:0}),d=e=>{if(s.current){let t=s.current.getBoundingClientRect();return e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom}return!1};return(0,l.useEffect)(()=>{let e=e=>{var t,n;if(!i)return;let r=e.touches[0];d({x:r.clientX,y:r.clientY})?null===(t=s.current)||void 0===t||t.classList.add("scale-110","bg-red-300"):null===(n=s.current)||void 0===n||n.classList.remove("scale-110","bg-red-300")};return window.addEventListener("touchmove",e),()=>{window.removeEventListener("touchmove",e)}},[i,s]),(0,r.jsx)("button",{onTouchStart:e=>{e.preventDefault(),o(!0),t();let n=e.touches[0];u.current={x:n.clientX,y:n.clientY}},onTouchEnd:e=>{e.preventDefault(),o(!1);let t=e.changedTouches[0];d({x:t.clientX,y:t.clientY})?c():n()},onContextMenu:e=>e.preventDefault(),className:"microphoneButton",children:a?a(i):"Press and Hold"})},s=n(1273),a=n(2859);let i=e=>{let{onStartPress:t,onEndPress:n,onCancel:i}=e,[o,u]=(0,l.useState)(!1),d=(0,l.useRef)(null);return(0,r.jsxs)("div",{className:"flex w-full justify-center items-center gap-6",children:[o&&(0,r.jsx)("button",{ref:d,className:"h-12 w-12 flex justify-center items-center text-xl rounded-full bg-red-200 text-red-600 ring-2 ring-red-600/50 transition-transform duration-200 ease-in-out hover:scale-110",children:(0,r.jsx)(s._0w,{})}),(0,r.jsx)(c,{onStartPress:()=>{u(!0),t()},onEndPress:()=>{u(!1),n()},onCancel:()=>{u(!1),i()},cancelButtonRef:d,children:e=>(0,r.jsx)("div",{className:"".concat(e?"bg-[#0039FF]/20 text-[#0039FF] ring-2 ring-[#0039FF]/40":"bg-[#0039FF] text-white","  px-14 py-6 text-3xl rounded-full"),children:(0,r.jsx)(a.J,{icon:e?s.ZTc:s.uYL})})}),o&&(0,r.jsx)("div",{className:"w-12"})]})}},3510:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(2265),l=n(9800),c=n(3974),s=n(6870);function a(e){let{onSpeechStart:t,onSpeechEnd:n,onAudioData:a,onRecordingStart:i,onRecordingStop:o,micVolume:u=1,recordingChunkSize:d}=e,x=(0,s.Y)(),m=(0,r.useRef)(null),f=(0,r.useRef)(null),g=(0,r.useRef)(null),h=(0,r.useRef)(null),v=(0,r.useRef)(!1),[p,j]=(0,r.useState)(!1),b=(0,r.useRef)(!1),[N,w]=(0,c.useLocalStorage)("selectedMic",null),[k,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{p?E():g.current&&M()},[p]);let S=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=e&&e!==N;if(e?w(e):e=N,!r){if(v.current){console.log("Mic already being acquired");return}if(m.current&&f.current&&g.current){console.log("Mic already acquired");return}}R(),v.current=!0;try{m.current=await navigator.mediaDevices.getUserMedia({audio:{deviceId:null!=e?e:void 0,echoCancellation:!0}}),console.log("Mic acquired",e);let r=m.current.getAudioTracks()[0].getSettings().deviceId;w(null!=r?r:null);let c=x.createMediaStreamSource(m.current);f.current=x.createGain(),c.connect(f.current),f.current.gain.value=u;let s=x.createMediaStreamDestination();f.current.connect(s),g.current=new MediaRecorder(s.stream),h.current=await l.MicVAD.new({workletURL:"/vad/vad.worklet.bundle.min.js",modelURL:"/vad/silero_vad.onnx",ortConfig:e=>{e.env.wasm.wasmPaths="/vad/"},stream:m.current,onSpeechStart:()=>{y(!0),null==t||t()},onVADMisfire:()=>{y(!1),null==n||n(!0)},onSpeechEnd:()=>{y(!1),null==n||n(!1)},positiveSpeechThreshold:.5,negativeSpeechThreshold:.35}),h.current.start()}catch(e){if(e instanceof DOMException&&"NotAllowedError"===e.name){console.log("User denied microphone access"),alert("Please allow microphone access to use this feature.");return}console.error("Error accessing microphone:",e),alert("Error accessing microphone: "+e);return}finally{v.current=!1}},E=async()=>{g.current||await S(),g.current&&(g.current.ondataavailable=e=>{null==a||a(e.data)},g.current.onstart=()=>{null==i||i()},g.current.onstop=()=>{null==o||o(b.current)},b.current=!1,await g.current.start(d))},M=()=>{g.current&&g.current.stop()},R=()=>{M(),m.current&&(m.current.getTracks().forEach(e=>{var t;e.stop(),null===(t=m.current)||void 0===t||t.removeTrack(e)}),m.current=null,console.log("Mic released")),f.current&&(f.current.disconnect(),f.current=null),g.current&&(g.current.stop(),g.current=null),h.current&&(k&&(y(!1),null==n||n(!1)),h.current.destroy(),h.current=null)};return(0,r.useEffect)(()=>{f.current&&(f.current.gain.value=u)},[u]),(0,r.useEffect)(()=>(console.log("Acquiring mic on mount"),S(),()=>{console.log("Releasing mic on unmount"),R()}),[]),{isRecording:p,setRecording:j,cancelRecording:()=>{b.current=!0,j(!1)},acquireMic:S,releaseMic:R,selectedMic:N,isVoiceDetected:k}}},9403:function(e,t,n){n.d(t,{f:function(){return l}});var r=n(3974);let l=()=>{let[e,t]=(0,r.useLocalStorage)("token");return{token:e,saveToken:t}}},434:function(e,t,n){n.d(t,{f:function(){return r}});let r=e=>e||"â€‹"}}]);